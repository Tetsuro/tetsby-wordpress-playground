{"data":{"wordpressPost":{"title":"Shopify Tutorial: Adding a Barchart for Inventory Using jQuery and JSON Objects","content":"<html><head></head><body><p>I was looking at t-shirts at an online store one day, and it had a nice little bar chart that displayed how much of each size it had left. I thought to myself, &#x201C;I wonder if this is doable in Shopify?&#x201D;. The answer is yes, thanks to jQuery and JSON Objects. In this tutorial, I&#x2019;ll be showing you how to add a bar chart in your product page that shows how much of each variant you have left in a bar chart. A big thank you to Javascript wizard <a href=\"http://www.tajimaphotography.com\" title=\"John Tajima Photography\">John Tajima</a> for introducing me to JSON objects and helping me out with the Javascript portion of this tutorial. </p>\n<p><img src=\"https://www.tetchi.ca/wp-content/uploads/2009/11/Screen-shot-2009-11-22-at-6.13.52-PM.jpg\" alt=\"Screen-shot-2009-11-22-at-6.13.52-PM\" title=\"Screen-shot-2009-11-22-at-6.13.52-PM\" width=\"588\" height=\"359\" class=\"alignnone size-full wp-image-719\"></p>\n<div class=\"sub\">The bar chart integrated into the <em>Moderno</em> theme.</div>\n<p>Implementing this feature can be done in three easy steps: adding the HTML/Liquid, adding the Javascript, and then adding the CSS. You can also fully customize the look of the bar chart with CSS. This bar chart will work for <em>any</em> theme, as long as you insert the HTML, Liquid, Javascript and CSS properly.<br>\n<!--more--><br>\nKeep in mind that this code will only work if you&#x2019;re tracking the inventory levels of your product&#x2019;s variant. In order to enable inventory tracking, you must navigate to your Product details page, and scroll down to where it lists the variants. Click the &#x2018;edit&#x2019; link next to the variants, and in the dropdown menu, select &#x201C;Shopify tracks this variant&#x2019;s stock level&#x201D;. Finally, enter the inventory level for this variant.</p>\n<p><img src=\"https://www.tetchi.ca/wp-content/uploads/2009/11/Screen-shot-2009-12-10-at-12.09.34-AM.png\" alt=\"Screen shot 2009-12-10 at 12.09.34 AM\" title=\"Screen shot 2009-12-10 at 12.09.34 AM\" width=\"588\" height=\"339\" class=\"alignnone size-full wp-image-898\"></p>\n<h2 class=\"steps\">The way it works:</h2>\n<p>The algorithm is best explained with an example. You have a t-shirt with 3 variants: small, medium, large. Let&#x2019;s say you have 2 smalls, 4 mediums, and 4 larges. </p>\n<p>The Javascript code will first calculate the total inventory level for ALL variants &#x2013; in this example, the total will be 10 (2 smalls + 4 mediums + 4 larges = 10). Then, for each variant, it will calculate the percentage of a single variant&#x2019;s inventory level versus. the total inventory level. This percentage is then used to determine the width of each bar. The percentages in our t-shirt example would be 20% for small, 40% for medium, and 40% for large, and the CSS will fill in the black bars accordingly. </p>\n<h2 class=\"steps\">1. Download jQuery and put it in the theme.</h2>\n<p>If you are unsure of how to do this, please see Steps 1 to 3 from my <a href=\"http://blog.tetsutakara.com/593/shopify-tutorial-making-sure-a-user-agrees-to-the-terms-conditions-using-jquery/\">last tutorial.</a></p>\n<h2 class=\"steps\">2. Insert the HTML/Liquid code inside of Product.liquid.</h2>\n<p>This is the code that is used to display the bar chart. Paste this code inside product.liquid where you want to output the bar chart. </p>\n<pre><code>\n{% if product.variants.size &gt; 1 %}\n  <div id=\"inventory\">\n    {% for variant in product.variants %}\n      <div class=\"inventory-item\">\n        <span>{{ variant.title }}</span><br>\n        <div class=\"inventory-bar\">\n          <div class=\"filler variant_{{forloop.index0}}\">&#xA0;</div>\n        </div>\n      </div>\n    {% endfor %}\n  </div>\n{% endif %}\n</code>\n</pre>\n<p>The code above first checks if the product has more than one variant. The bar chart will only show if there is more than one variant, because there is not much point in making a bar chart if there is only one bar to show. </p>\n<p>Next, the for-loop creates a div with the class &#x201C;inventory-bar&#x201D; for each variant. The &#x201C;inventory-bar&#x201D; div has a gray background has a width of 100% (which means that it will be the width of the &#x201C;inventory&#x201D; div. The div within &#x201C;inventory-bar&#x201D; is the black &#x2018;filler&#x2019; bar that will expand its width depending on how much inventory for the variant is available. The filler bar is assigned a width in percentage by the Javascript in Step 3. </p>\n<p>The next function then takes the inventory level of each variant, and assigns the CSS property &#x2018;width&#x2019; in percentage. The percentage is calculated by dividing the variant&#x2019;s inventory level by the total inventory, and then multiplying the result by 100. Using jQuery, the class variant_i (where &#x2018;i&#x2019; is the index number of the loop) is assigned an inline style with the calculated width. </p>\n<h2 class=\"steps\">3. Insert the Javascript/jQuery code.</h2>\n<p>Below the code from Step 2, insert the following Javascript/jQuery code. </p>\n<pre><code>\n<script type=\"text/javascript\">\njQuery(document).ready(function($){\n  var product_json = {{ product | json }};\n  // get total inventory of product\n  var total_inventory = 0;\n  jQuery.each(product_json.variants, function(i, v) { \n    total_inventory += v.inventory_quantity \n  });\n  // replace inventory bars for variants\n  jQuery.each(product_json.variants, function(i, v){\n    var count = v.inventory_quantity;\n    if (count == 0) {\n      $('.variant_'+i).css({'background':'none'}).html('<span class=\"message\">Sold Out</span>');\n    } else {\n      $('.variant_'+i).css({'width': ((count / total_inventory)*100) + \"%\"});      \n    }\n  });\n});\n</script>\n</code>\n</pre>\n<p>The code above  first creates a JSON object of the product that you are currently viewing, using Liquid&#x2019;s &#x201C;json&#x201D; filter. We want to convert the product into a JSON object because it will allow us to use Javascript for calculations (unfortunately, Liquid alone is not sufficient, as it does not have many math functions). </p>\n<p>Next, it loops through each of the variants of the product, and calculates the total of all variant inventories and stores them in a variable called total_inventory.</p>\n<p>The last function takes the inventory level of each variant, and assigns the CSS property &#x2018;width&#x2019; in percentage. The percentage is calculated by dividing the variant&#x2019;s inventory level by the total inventory, and then multiplying the result by 100. Using jQuery, the class variant_i (where &#x2018;i&#x2019; is the index number of the loop) is assigned an inline style with the calculated width. The CSS class variant_i is matched up with the variant_{{forloop.index0}} in the for-loop from the HTML code in Step 2, which ensures that the right width is assigned to the right variant. </p>\n<p>However, if the variant&#x2019;s inventory level is 0, the bar for the variant will not be given a width, and instead it will display a message that says &#x201C;Sold Out&#x201D;. </p>\n<h2 class=\"steps\">4. Insert the CSS code.</h2>\n<p>Inside your CSS file, insert the following selectors for the bar chart.</p>\n<pre><code>\n\n#inventory{\n        /*Give this div a width if you&apos;d like to set the barcharts to a certain width. Otherwise, it will take on the width of its parent div. */\n}\n\n.filler{\n\tbackground:#000;\n}\n\n.inventory-item{\n\tmargin-bottom:15px;\n}\n\n.inventory-bar{\n\tbackground:#e1e1e1;\n\theight:20px;\n\twidth:100%;\n}\n</code>\n</pre>\n<p>The simple CSS above styles the bar chart. By using your own CSS, you can customize the color, margin, width, etc. in any way that you like.</p>\n<p>Here are some examples of the bar charts in action, in different themes:</p>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block;  max-width: 588px; margin-left: auto; margin-right: auto;\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 75.51020408163265%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAADyElEQVQ4y4WS60+bVRzH+zf4Rv8AX0xfmDiYQLIwZOUN12xL2LiMSaVDhIlc2tKyZUCyqLDRdmzITYbFyYS2mo7LBpR7R0HWwjIQdFGLSC8MylPaUp4eztfTZ4sxZtGTfPKcc3LOJ9/f8zuiwa7OqLHhH5pnrPOa2Vmrdnp6WmuxWAQWFha0Vuvs33s2u01rs9m0dvui9rHNrp2bn9cuLT3RPl1eVlutc1/29eljRZqGemm/yQiDQY8HQ0OYmJjA8PCwwNTUFCwzFpjNZphM/RgcGBT2JtmZsdFhDPabYB55iHHzKFuPQN3YWCqSZhw/r/ogGaWn4kJj/QZ+y+vn/RzH7zF2GYeU8upGDR8d8zZ/PD6GX3qyzI/03eGVuWJekZvEy7PFvCzr/dDVgjTo2poKRQXJx/KUOYkoST1KZkdM1A8gjJcj/GK2svITXn/jNWRlZwrrft0tVJyOReSeIiuBKs6dIHUFKTDqWotE0tSYPNX5JBSnHCX22XGKP10ITExi37aIoHdXEDjW15GenoG62lph/fBeO5RZCajKToTsXAKVM+Hl/BRUf36zSFSQEhGKmfBd8viRmWLDCY4Jd+Z+RDB0gAOeh8ezBZ/Phz1GZOg7GlGSFoWqnJOoPJtAZWfjifJCMgqv/kPIDhCreYAGDoHnwQA4nslCIYT5MLxeL/b29hDw+wWh8Ss1Ox8NBUtYyRLKMuOJigmLa/8ltIzcpzteDhsOB1xOJ1wuF9yM7e1tAefmJkI8YUKNkFD+n8LUKDI/PkQPKeCPpAkEBPwsVQSPxwOP2w1WAL7v1KD4FcKPa14Klbkn8empGGL8poPe7fkO3Tod9Ho9jEaj8B0YGBBK3t/fF0o2dKj/J2GuGJ9kHCOjpl66svoz1lZX4WBlr62tYZXNf3n2TGgKt7srJDQITYl+dUJpWpzwbMrOxBFDdzvtvttD73R2UrN5lIbDYcrzPD04OKCsIdTHcZT9EcqaQi9lvEcVOWIqz0pkzyaBVOenoqS2qUh0QfxOXsWZOBQmvcWP3e8lv61vEJaMOJ1OwkokwQjBIPH7A4TjOMICkt6WL8hF8RFSdjqWlLLKStOj+IrME5Be0XwkuvFZzYd93W34ukWNxUU73F4fvD4/3LsB/OrawR+uLTjYY9/0PIdj043fPRwezUxC16rGt53NArpWDYw9Xbjdde+SqKrm2pv1N1ukN5o78qtr6iSlZeWS8kqZpFymkMhVlyWViipJhUwukStVL2B7165rJNdvt0vqm1olDbcitOU3NLVcVClkR/4C/NNC/aDMVzoAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\"></span>\n    <img class=\"gatsby-resp-image-image alignnone size-full wp-image-891\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\" alt=\"dropify2\" title=\"dropify2\" src=\"/static/7e888e0d4ba5cc4fe8fec478bf63a09f/4214e/dropify2.png\" srcset=\"/static/7e888e0d4ba5cc4fe8fec478bf63a09f/19bd1/dropify2.png 163w,\n/static/7e888e0d4ba5cc4fe8fec478bf63a09f/d3bcb/dropify2.png 325w,\n/static/7e888e0d4ba5cc4fe8fec478bf63a09f/4214e/dropify2.png 588w\" sizes=\"(max-width: 588px) 100vw, 588px\">\n  </span></p>\n<div class=\"sub\">The bar chart in the Dropify theme.</div>\n<p><span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block;  max-width: 588px; margin-left: auto; margin-right: auto;\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 80.95238095238095%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAADKElEQVQ4y4WUzU8TURTF+x/gEkTiipiQYIzu2ckOjImkVRP/AWAFhISNknRQhEgCC0KisDIoCyQqEAi0DG1pC4G2IG0pnwUSSstXKR/tdN473veAgorhJSed1+n83rn3nqnhW0dH/lh/91urzWZ2TjjNExMTisPhUFwutzIzM6Ooqio1OjqqjI2NKdPT04rP51OmpqYUp9OpeDweM+3Ndru9saenp8Dwoanp2dDgTwwOj0BVx0EPnUuF2+UCwUE/lrLZbFIEgtVqhdVikfcJjvFxGxobG18ZhoaHS8LhdQSDgRSdpnm8Xs3r9WnkTqOTtVAopAWDQfm5srKibW5uyr3f79d+zc1pXV1d2uTkZHJzYwP9P74bDbOzs09AKxKJMCqH+wMBbNDNWCyGo6MjXF1bkQg6OzsRj8flnjEde3t7HOBM7PuskyYDuZLAg4MDtrW1xff395HWNMQTJ6QjnJycyIffNTSgtLQE2dnZqK6uPgcycTDX0xo71YHXn9VLYCKRYO3t7by5uVn0AqrNnnFGA8H9wgI8evgAeXl3UFRUJGFikQHOmc5StFW+jF8C4/ED5na7uGi4aHQotIBodFs+1NT0Hjm5t5BzOxtZWVkoLn4sv+ecQ9QrzCbJofLVdgmkk9j29jannlAZO6IFso+pVArUCtTU1IBigd7eXrjd7kzJXFCvAmmaEkiDYD7fLF9YWKCJB7G0tIzQ4iJ2dnaxurqGTx87oWlp0ODk0DIOrwDNVx3uxGKMosGXl5cRDochPmkPnVw47A4U5t+D1+tFWVkZ6uvf/N/hBZBKZQTiAraxvo510ho526fSEzTt+Xk/kskkdnd3cXh4eK3Df0qmay7KFf0TWRP6O4sX64yDDFDEpr6bpkwpl0CLxcJaWlr4yMgIpwhxAkkdHx9zXdelqMSMLpa4FECNYtPed+awVADpXdVbW1v1QCDIKMyMymOnp6eMpiwCd5PSguH1zJgMFNqndDr9Mahoa2uT0aD4ZBSNRmXPyPW1EveExBs1MDDw0mAymXLLy8ufV1VVmerq6ky1tbWmysrKP1RRUXGTjKQXRqPx7m9TliENtmq/JQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n    <img class=\"gatsby-resp-image-image alignnone size-full wp-image-895\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\" alt=\"minimify\" title=\"minimify\" src=\"/static/5fa6cea7fbd3737b832b22db06157f5c/4214e/minimify.png\" srcset=\"/static/5fa6cea7fbd3737b832b22db06157f5c/19bd1/minimify.png 163w,\n/static/5fa6cea7fbd3737b832b22db06157f5c/d3bcb/minimify.png 325w,\n/static/5fa6cea7fbd3737b832b22db06157f5c/4214e/minimify.png 588w\" sizes=\"(max-width: 588px) 100vw, 588px\">\n  </span></p>\n<div class=\"sub\">The bar chart in the Minimify theme.</div>\n<h2 class=\"steps\">Conclusion:</h2>\n<p>Originally, I had wanted to use just Liquid to accomplish this, but in the end I had to use a combination of Liquid and Javascript because Liquid cannot do many math functions. With that said I&#x2019;m pretty happy that I used Javascript because I learned a great deal about JSON objects. (thanks again <a href=\"http://www.tajimaphotography.com\" title=\"John Tajima Photography\">John</a>!).  I hope you find this technique useful, and I hope to see this in some themes in the future!</p>\n</body></html>"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"adding-a-barchart-for-inventory-using-jquery-and-json-objects"}}
{"data":{"wordpressPost":{"title":"Shopify Theme from Scratch Part 8: article.liquid","content":"<p><img data-src=\"https://www.tetchi.ca/wp-content/uploads/2013/05/part8_banner.png\" alt=\"part8_banner\" width=\"800\" height=\"186\" class=\"alignnone size-full wp-image-3405 lazy-load\" data-srcset=\"https://www.tetchi.ca/wp-content/uploads/2013/05/part8_banner.png 800w, https://www.tetchi.ca/wp-content/uploads/2013/05/part8_banner-300x69.png 300w\" sizes=\"(max-width: 800px) 100vw, 800px\" /></p>\n<p>Once a user clicks on an article listed on the blog.liquid template, they are taken to the article.liquid template. The article.liquid template is where the full article is shown. Users also have the option to leave comments to articles through this template.</p>\n<p>Let&#8217;s butter some biscuits!</p>\n<p><!--more--></p>\n<h2 class=\"step\">1. Output the article content and information</h2>\n<p>Let&#8217;s start off by outputting the article&#8217;s content and information (publish date, number of comments, tags). I won&#8217;t go into too much detail here as it&#8217;s essentially the same code from Part 7 :). A for-loop is not necessary here because we&#8217;re only outputting one article, i.e. the one that we&#8217;re currently viewing. We&#8217;re also replacing {{ article.excerpt_or_content }} with just {{ article.content }}, because there is no need to output the excerpt here.</p>\n<p>Open the article.liquid template, and replace its contents with the following code:</p>\n<pre>\n<code>&lt;div class=\"blog-article single-article\"&gt;\n  &lt;h1 class=\"blog-title\"&gt;{{ article.title }}&lt;/h1&gt;\n  &lt;div class=\"blog-data\"&gt;\n    {{ article.published_at | date: '%b %d, %Y' }}\n    {% if blog.comments_enabled? %}\n    - &lt;a href=\"{{ article.url }}#comments\"&gt;{{ article.comments_count }} {{ article.comments_count | pluralize: 'comment','comments' }}&lt;/a&gt;\n    {% endif %}\n  &lt;/div&gt;\n  &lt;div class=\"blog-content rte\"&gt;\n    {{ article.content }}\n  &lt;/div&gt;\n  {% if article.tags.size &gt; 0 %}\n  &lt;div class=\"blog-tags\"&gt;\n    tags:\n    {% for tag in article.tags %} \n    &lt;a href=\"{{ blog.url }}/tagged/{{ tag | handle }}\"&gt;{{ tag }}&lt;/a&gt;{% unless forloop.last %}, {% endunless %}\n    {% endfor %}\n  &lt;/div&gt;  \n  {% endif %}\n&lt;/div&gt;</code>\n</pre>\n<p>You should now see the contents of the article being output, as well as the date, the number of comments, and tags (if the article contains tags), as shown in Figure 8.1.</p>\n<p><a href=\"https://www.tetchi.ca/wp-content/uploads/2013/06/article-template.jpg\"><img data-src=\"https://www.tetchi.ca/wp-content/uploads/2013/06/article-template.jpg\" alt=\"article template\" width=\"1020\" height=\"618\" class=\"alignnone size-full wp-image-3425 lazy-load\" data-srcset=\"https://www.tetchi.ca/wp-content/uploads/2013/06/article-template.jpg 1020w, https://www.tetchi.ca/wp-content/uploads/2013/06/article-template-300x181.jpg 300w\" sizes=\"(max-width: 1020px) 100vw, 1020px\" /></a></p>\n<div class=\"sub\">Figure 8.1: Contents of a single article being output.</div>\n<h2 class=\"step\">2. List the article comments</h2>\n<p>Let&#8217;s start off by writing some Liquid to check if the storeowner has comments enabled.  After all, there&#8217;s no point in outputting comments or a comment form if the storeowner has blog comments disabled! Blog comments are enabled in the Blog details page in the admin (Figure 8.2)</p>\n<p><a href=\"https://www.tetchi.ca/wp-content/uploads/2013/06/blog-comment-settings.jpg\"><img data-src=\"https://www.tetchi.ca/wp-content/uploads/2013/06/blog-comment-settings.jpg\" alt=\"blog comment settings\" width=\"1256\" height=\"731\" class=\"alignnone size-full wp-image-3411 lazy-load\" data-srcset=\"https://www.tetchi.ca/wp-content/uploads/2013/06/blog-comment-settings.jpg 1256w, https://www.tetchi.ca/wp-content/uploads/2013/06/blog-comment-settings-300x174.jpg 300w, https://www.tetchi.ca/wp-content/uploads/2013/06/blog-comment-settings-1024x595.jpg 1024w\" sizes=\"(max-width: 1256px) 100vw, 1256px\" /></a></p>\n<div class=\"sub\">Figure 8.2: Blog details page of the admin</div>\n<p>At the bottom of the article.liquid, add the code in red below:</p>\n<pre>\n<code>...\n  &lt;div class=\"blog-tags\"&gt;\n    tags:\n    {% for tag in article.tags %} \n    &lt;a href=\"{{ blog.url }}/tagged/{{ tag | handle }}\"&gt;{{ tag }}&lt;/a&gt;{% unless forloop.last %}, {% endunless %}\n    {% endfor %}\n  &lt;/div&gt;  \n  {% endif %}\n&lt;/div&gt;\n\n<span style=\"color:red;\">{% if blog.comments_enabled? %}\n\n{% endif %}</span></code>\n</pre>\n<p>This if-statement checks to see if comments are enabled in the blog&#8217;s settings.</p>\n<p>Now let&#8217;s go ahead and output the comments that have been added to the blog. Between the if-statement that we just added, insert the following code in red:</p>\n<pre>\n<code>{% if blog.comments_enabled? %}\n\n<span style=\"color:red;\">{% if article.comments.size &gt; 0 %}\n&lt;div class=\"comments\"&gt;\n  &lt;h2&gt;Comments ({{ article.comments_count }})&lt;/h2&gt;\n  {% for comment in article.comments %}\n  &lt;div class=\"comment\"&gt;\n    &lt;div class=\"comment-data\"&gt;\n      <span class=\"comment-author\">{{ comment.author }}</span> &lt;small&gt;on {{ comment.created_at | date: \"%B %d, %Y\" }}&lt;/small&gt;\n    &lt;/div&gt;\n    &lt;div class=\"comment-content\"&gt;\n      {{ comment.content }}\n    &lt;/div&gt;\n  &lt;/div&gt;\n  {% endfor %}\n&lt;/div&gt;\n{% endif %}</span>\n\n{% endif %}</code>\n</pre>\n<p>Here, we&#8217;re looping through the &#8216;comments&#8217; array of the current article, and accessing the variables of each &#8216;comment&#8217; object. This includes information such as the author of the comment, the email of the author of the comment, when it was written, etc. To see a full list of the comment object&#8217;s variables, please see this <a href=\"http://docs.shopify.com/themes/liquid-variables/article#comment-attributes\">page</a>.</p>\n<p>If you&#8217;re working on a fresh shop, you may not have any article comments to display yet. If this is the case you can add some through the form that we&#8217;re going to be creating in the next step.</p>\n<h2 class=\"step\">3. Add the comment form</h2>\n<p>Directly below the if-statement that checks for &#8220;article.comments.size > 0&#8221;, paste the code in red below.</p>\n<pre>\n<code>...\n\n{% if article.comments.size &gt; 0 %}\n&lt;div class=\"comments\"&gt;\n  &lt;h2&gt;Comments ({{ article.comments_count }})&lt;/h2&gt;\n  {% for comment in article.comments %}\n  &lt;div class=\"comment\"&gt;\n    &lt;div class=\"comment-data\"&gt;\n      &lt;strong&gt;{{ comment.author }}&lt;/strong&gt; &lt;small&gt;on {{ comment.created_at | date: \"%B %d, %Y\" }}&lt;/small&gt;\n    &lt;/div&gt;\n    &lt;div class=\"comment-content\"&gt;\n      {{ comment.content }}\n    &lt;/div&gt;\n  &lt;/div&gt;\n  {% endfor %}\n&lt;/div&gt;\n{% endif %}\n\n<span style=\"color:red;\">&lt;div class=\"comment-form\"&gt;\n  {% form article %}\n  &lt;h2&gt;Leave a comment:&lt;/h2&gt;\n\n  &lt;div class=\"comment-entries\"&gt;\n    \n      &lt;label for=\"comment-author\"&gt;Name&lt;/label&gt;\n      &lt;input {% if form.errors contains \"author\" %} class=\"error\"{% endif %} type=\"text\" name=\"comment[author]\" placeholder=\"Your name\" value=\"{{ form.author }}\" /&gt;\n    \n\n    \n      &lt;label for=\"comment-email\"&gt;Email&lt;/label&gt;\n      &lt;input {% if form.errors contains \"email\" %} class=\"error\"{% endif %} type=\"email\" name=\"comment[email]\" placeholder=\"your@email.com\" value=\"{{ form.email }}\" /&gt;\n    \n\n    \n      &lt;label for=\"comment-body\"&gt;Message&lt;/label&gt;\n      &lt;textarea {% if form.errors contains \"body\" %} class=\"error\"{% endif %} name=\"comment[body]\"&gt;{{ form.body }}&lt;/textarea&gt;\n    \n\n  &lt;/div&gt;\n  &lt;input type=\"submit\" value=\"Post Comment!\" class=\"btn\"/&gt; \n\n  {% endform %}\n&lt;/div&gt;</span>\n{% endif %}</code>\n</pre>\n<p>This will give you a snazzy comment form that will allow visitors to leave comments to articles (Figure 8.3).</p>\n<p><a href=\"https://www.tetchi.ca/wp-content/uploads/2013/06/article-comment-form.jpg\"><img data-src=\"https://www.tetchi.ca/wp-content/uploads/2013/06/article-comment-form.jpg\" alt=\"article comment form\" width=\"1009\" height=\"790\" class=\"alignnone size-full wp-image-3426 lazy-load\" data-srcset=\"https://www.tetchi.ca/wp-content/uploads/2013/06/article-comment-form.jpg 1009w, https://www.tetchi.ca/wp-content/uploads/2013/06/article-comment-form-300x234.jpg 300w\" sizes=\"(max-width: 1009px) 100vw, 1009px\" /></a></p>\n<div class=\"sub\">Figure 8.3: The blog comments form </div>\n<h2 class=\"step\">4. Adding error/success messages</h2>\n<p>Next, we need to add some error checking to prevent visitors from submitting incomplete forms. This is made easy thanks to the form objects&#8217; &#8220;errors&#8221; variable.</p>\n<p>Still inside article.liquid, insert the code in red below:</p>\n<pre>\n<code>...\n&lt;div class=\"comment-form\"&gt;\n  {% form article %}\n  &lt;h2&gt;Leave a comment:&lt;/h2&gt;\n\n  <span style=\"color:red;\">{% if form.errors %}\n  &lt;div class=\"errors\"&gt;\n    {{ settings.comments_error_message }}\n    {% for field in form.errors %}\n    The {{ field | capitalize | replace: 'Body', 'Message' }} field {{ form.errors.messages[field] }}.\n    {% endfor %}\n  &lt;/div&gt;\n  {% endif %}\n  {% if form.posted_successfully? %}\n  &lt;div class=\"success\"&gt;\n    \n    {% if blog.moderated? %}\n      Your comment needs to be approved by the blog owner.\n    {% else %}\n      Successfully posted your comment.\n    {% endif %}\n    \n  &lt;/div&gt;\n  {% endif %}</span>\n\n  &lt;div class=\"comment-entries\"&gt;\n    \n      &lt;label for=\"comment-author\"&gt;Name&lt;/label&gt;\n      &lt;input {% if form.errors contains \"author\" %} class=\"error\"{% endif %} type=\"text\" name=\"comment[author]\" placeholder=\"Your name\" value=\"{{ form.author }}\" /&gt;\n    \n...</code>\n</pre>\n<p>Now, when you try to submit a comment without properly filling out the form, you will be shown an error message (Figure 8.4).</p>\n<p style='text-align:center;'>\n<a href=\"https://www.tetchi.ca/wp-content/uploads/2013/06/form-error.jpg\"><img data-src=\"https://www.tetchi.ca/wp-content/uploads/2013/06/form-error.jpg\" alt=\"form error\" width=\"358\" height=\"355\" class=\"alignnone size-full wp-image-3428 lazy-load\" data-srcset=\"https://www.tetchi.ca/wp-content/uploads/2013/06/form-error.jpg 358w, https://www.tetchi.ca/wp-content/uploads/2013/06/form-error-150x150.jpg 150w, https://www.tetchi.ca/wp-content/uploads/2013/06/form-error-300x297.jpg 300w\" sizes=\"(max-width: 358px) 100vw, 358px\" /></a>\n</p>\n<div class=\"sub\">Figure 8.4: An error message is returned if a customer does not complete the comment form</div>\n<h2 class=\"step\">5. Add the CSS</h2>\n<p>Let&#8217;s go ahead and pretty up the article page. Open style.css, and insert the CSS code below at the very bottom of the CSS file.</p>\n<pre>\n<code>/**** article.liquid ****/ \n\n.single-article{border-bottom:none; margin-bottom: 0;}\n\n.comments{border-top:1px solid #ccc; margin-bottom:30px;}\n.comment{margin-bottom: 30px;}\n.comment-author{font-weight:bold; font-size:20px;}\n\n.comment-entries label, .comment-entries input, .comment-entries textarea{ display:block;}\n.comment-entries label{font-size:14px;}\n.comment-entries input, .comment-entries textarea{border: 1px solid #ccc; padding:5px;}\n.comment-entries textarea{width:350px; height:180px;}\n\n.errors{color:#e00000;}\n.error{border: 1px solid #e00000 !important;}\n.success{color:#5BB85E;}</code>\n</pre>\n<p>Your article page should now look like this:</p>\n<p><a href=\"https://www.tetchi.ca/wp-content/uploads/2013/06/article-final-1.jpg\"><img data-src=\"https://www.tetchi.ca/wp-content/uploads/2013/06/article-final-1.jpg\" alt=\"article final 1\" width=\"1002\" height=\"861\" class=\"alignnone size-full wp-image-3435 lazy-load\" data-srcset=\"https://www.tetchi.ca/wp-content/uploads/2013/06/article-final-1.jpg 1002w, https://www.tetchi.ca/wp-content/uploads/2013/06/article-final-1-300x257.jpg 300w\" sizes=\"(max-width: 1002px) 100vw, 1002px\" /></a></p>\n<p>The CSS includes styles for the form and its error/success messages as well :)</p>\n<p><a href=\"https://www.tetchi.ca/wp-content/uploads/2013/06/errors-styled.jpg\"><img data-src=\"https://www.tetchi.ca/wp-content/uploads/2013/06/errors-styled.jpg\" alt=\"errors styled\" width=\"398\" height=\"562\" class=\"alignnone size-full wp-image-3429 lazy-load\" data-srcset=\"https://www.tetchi.ca/wp-content/uploads/2013/06/errors-styled.jpg 398w, https://www.tetchi.ca/wp-content/uploads/2013/06/errors-styled-212x300.jpg 212w\" sizes=\"(max-width: 398px) 100vw, 398px\" /></a></p>\n<p>That&#8217;s it for this week!</p>\n<p><a href=\"/shopify-theme-from-scratch/\">&larr; Back to table of contents</a></p>\n"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"shopify-theme-from-scratch-part-8"}}
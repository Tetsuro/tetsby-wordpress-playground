{"data":{"wordpressPost":{"title":"Autodesk Maya: Exporting to FBX","content":"<p>For Senior Project at school, I was responsible for modeling and animating 3D fishes. The app that we were using required me to export the models into FBX file. I learned the hard way that exporting to FBX is a HUGE pain in the butt, and hopefully this article can smooth things out for anyone working with Maya &amp; FBX.</p>\n<h2 class=\"steps\">Thing to keep in mind when exporting to FBX</h2>\n<ul>\n<li>Deformer animations simply do not work. I&#8217;ve browsed through many, many forums looking for a solution but could not find an answer. What happens is that once exported to FBX, only the first frame will have the deformers applied, but not for any frames after that. This means that for the rest of the animation, the object being deformed will maintain the same shape from the first frame.</li>\n<li>Blend shapes work! You just have to re-arrange the Input Orders (explained later)</li>\n<li>Constraints may not alway work. I used parent constraints for my eyes and some of the controls, but they would do odd things when exported. For example, even though they&#8217;d work perfectly as an .mb file, in the FBX file there would be an offset on the objects that were constrained, so they wouldn&#8217;t be in the right positions.</li>\n<li>You have to delete non-deformer history after you smooth your mesh. Otherwise, even when your model is exported, it will still be unsmoothed.</li>\n<li>Make sure all your normals are facing the right way. To see normals, go to <strong>Display &gt; Polygons &gt; Face Normals</strong>. Not having the normals pointing the right way will mess up many things in the app/game, primarily the lighting.</li>\n</ul>\n<p>Below, I&#8217;ve outlined the steps to properly export an FBX file. There is also a <a href=\"http://www.youtube.com/watch?v=MqyGvEXuif4\" target=\"_blank\">supplementary video</a> that may help you get started. At this point, you should have the character modeled, textured, the joints and controls set up, and the mesh for any blend shapes created.</p>\n<p style=\"text-align:center;\">\n<img class=\"aligncenter size-medium wp-image-1547 lazy-load\" title=\"The Initial setup of the Maya scene\" data-src=\"https://www.tetchi.ca/wp-content/uploads/2011/04/Screen-shot-2011-04-08-at-8.09.49-PM-588x317.png\" alt=\"initial setup\" width=\"588\" height=\"317\" />\n</p>\n<div class=\"sub\">Fig. 1: The initial setup</div>\n<p><!--more--></p>\n<h2 class=\"steps\">The proper steps for exporting to FBX</h2>\n<h3>1. Smooth-bind the mesh to your rig.</h3>\n<p>Make sure you have the Animation menu open. Select the root joint, then select the mesh. Go to <strong>Skin &gt; Bind Skin &gt; Smooth Bind</strong>. Now, when you move your joints, your mesh should move as well. Don&#8217;t smooth just yet! Keep working in smooth-preview mode for now (hit 3 on your keyboard).</p>\n<h3>2. Weight paint the non-smoothed mesh.</h3>\n<p>You should now go ahead and weight-paint your model. I won&#8217;t go over the details on how to weight paint here, but I found <a title=\"weight paint tutorial\" href=\"http://www.youtube.com/watch?v=xMuo8SsIaQA\">this tutorial</a> by unpicked1 very useful. It&#8217;s easier if you weight-paint before you smooth, since there are less vertices to worry about.</p>\n<p style=\"text-align:center;\"><img class=\"aligncenter size-medium wp-image-1535 lazy-load\" title=\"weight-painting the fish\" data-src=\"https://www.tetchi.ca/wp-content/uploads/2011/04/Screen-shot-2011-04-08-at-7.32.36-PM-588x469.png\" alt=\"weight-painting the fish\" width=\"588\" height=\"469\" />\n</p>\n<div class=\"sub\">Fig. 2: Weight painting the fish, with Color Ramps.</div>\n<p>You only have to weight paint one side of your character. You can use the <strong>Mirror Skin Weight</strong> tool later to copy the weights from one side to another. When you use this tool, make sure your character is in its bind pose.</p>\n<h3>3. Animate the model.</h3>\n<p>Use your rig to animate the model. Walk, jump, swim&#8230; go nuts!</p>\n<h3>4. Smooth the mesh</h3>\n<p>Switch to the Polygons menu. Select the mesh, and go to <strong>Mesh &gt; Smooth</strong>. If you have any meshes for blend shapes, go ahead and smooth them too. You may be tempted to export to FBX right away, but if you do now, your FBX model&#8217;s mesh will not be smoothed. Once you smooth it, you may have to weight-paint certain areas that may not be moving as they should.</p>\n<p style=\"text-align:center;\"><img class=\"aligncenter size-medium wp-image-1540 lazy-load\" title=\"smoothed meshes\" data-src=\"https://www.tetchi.ca/wp-content/uploads/2011/04/Screen-shot-2011-04-08-at-7.56.34-PM-588x350.png\" alt=\"smoothed meshes\" width=\"588\" height=\"350\" /></p>\n<div class=\"sub\">Fig.3: All meshes are now-smoothed, including the blend shapes.</div>\n<h3>5. Delete Non-Deformer History.</h3>\n<p>Go to <strong>Edit &gt; Delete by Type &gt; Options</strong>. Make sure that &#8220;All non-deformer history&#8221; is selected (Fig. 4).</p>\n<p style=\"text-align:center;\"><img class=\"aligncenter size-full wp-image-1544 lazy-load\" title=\"delete non-deformer history options\" data-src=\"https://www.tetchi.ca/wp-content/uploads/2011/04/Screen-shot-2011-04-08-at-8.07.56-PM.png\" alt=\"delete non-deformer history options\" width=\"574\" height=\"330\" data-srcset=\"https://www.tetchi.ca/wp-content/uploads/2011/04/Screen-shot-2011-04-08-at-8.07.56-PM.png 574w, https://www.tetchi.ca/wp-content/uploads/2011/04/Screen-shot-2011-04-08-at-8.07.56-PM-300x172.png 300w, https://www.tetchi.ca/wp-content/uploads/2011/04/Screen-shot-2011-04-08-at-8.07.56-PM-500x287.png 500w\" sizes=\"(max-width: 574px) 100vw, 574px\" />\n</p>\n<div class=\"sub\">Fig. 4: Delete Non-Deformer History Options</div>\n<p>Select the main mesh (not the blend shapes). Go to <strong>Edit &gt; Delete by Type</strong>. This deletes the smooth node from the mesh, so now when you export it, it will be smooth in the FBX as well! If you did a simple Delete History, it would have deleted the smooth, but all weight-paint information and animations will be lost.</p>\n<h3>6. Create blend shape.</h3>\n<p>Switch to the Animation menu. Select the blend shape mesh, Shift+Select the main mesh, then go to <strong>Create Deformers &gt; Blend Shape</strong>. The main mesh should now have a new attribute for the blend shape. When this new attribute gets closer to 1, the main mesh becomes more and more similar to the blend shape. Notice how in Fig.5, the goldfish&#8217;s mouth is now open like the blend shape.</p>\n<p style=\"text-align:center;\">\n<img class=\"aligncenter size-medium wp-image-1551 lazy-load\" title=\"blend shape created\" data-src=\"https://www.tetchi.ca/wp-content/uploads/2011/04/Screen-shot-2011-04-08-at-8.19.16-PM-588x328.png\" alt=\"blend shape created\" width=\"588\" height=\"328\" />\n</p>\n<div class=\"sub\">Fig.5: The mesh now has a blend shape.</div>\n<h3>7. Change Input Orders</h3>\n<p>The problem right now is that the blend shape is now prioritized over the animations. This means that if the value for the blend shape attribute is set to 1, the mesh will take on the blend shape for the duration of timeline instead of doing the animations. To fix this, we must change the input orders of the main mesh. Right click and hold on the main mesh, and go to <strong>Inputs &gt; All Inputs</strong> (Fig. 6).</p>\n<p style=\"text-align:center;\">\n<img class=\"aligncenter size-medium wp-image-1555 lazy-load\" title=\"All Inputs menu\" data-src=\"https://www.tetchi.ca/wp-content/uploads/2011/04/Screen-shot-2011-04-08-at-8.32.10-PM-588x324.png\" alt=\"\" width=\"588\" height=\"324\" />\n</p>\n<div class=\"sub\">Fig.6: Opening the All Inputs menu.</div>\n<p>You will now see all the inputs of that mesh. Middle-click and drag the Blend Shape node on top of the Tweak node (when you middle-click over the Blend Shape node, you should see a plus sign). See Fig.7.</p>\n<p style=\"text-align:center;\"><img class=\"aligncenter size-medium wp-image-1558 lazy-load\" title=\"before and after of inputs\" data-src=\"https://www.tetchi.ca/wp-content/uploads/2011/04/blendshape-588x204.png\" alt=\"before and after of inputs\" width=\"588\" height=\"204\" />\n</p>\n<div class=\"sub\">Fig. 7: Before and After of Inputs for main mesh.</div>\n<p>Now, even with the blend shape attribute set to 1, the model will retain its animation, PLUS have the blend shape applied.</p>\n<h3>8. Include blend shapes into animation</h3>\n<p>You can no go ahead and keyframe the blend shapes into your animation. For me, I used the fish&#8217;s blend shape to animate the opening/closing of the fish&#8217;s mouth (Fig. 8).</p>\n<p style=\"text-align:center;\"><img class=\"aligncenter size-medium wp-image-1563 lazy-load\" title=\"correct input orders\" data-src=\"https://www.tetchi.ca/wp-content/uploads/2011/04/Screen-shot-2011-04-08-at-8.44.01-PM-588x376.png\" alt=\"correct input orders\" width=\"588\" height=\"376\" />\n</p>\n<div class=\"sub\">Fig. 8: Animated goldfish with the right input orders</div>\n<h3>9. Check export options &amp; export</h3>\n<p>Go to <strong>File &gt; Export Selection&#8230; &gt; Options</strong>. Under file type, select &#8220;FBX export&#8221;. Click the &#8220;Edit preset&#8221; button to open the FBX export options. In the options for the FBX export, look over the following:</p>\n<ul>\n<li>Under &#8220;Animation&#8221;, make sure the Animation checkbox is checked.</li>\n<li>Under &#8220;Bake Animation&#8221;, make sure the Bake Animation checkbox is checked. Also, set the Start and End values to the duration of your animation.</li>\n<li>Under &#8220;Deformed Models&#8221;, make sure all checkboxes are checked</li>\n</ul>\n<p>Once this is done. select your model or the group containing your model. Go to <strong>File &gt; Export Selection&#8230;</strong>. Export the FBX model to the directory of your choice. You should now have a fully-working FBX model.</p>\n<p>I made a supplementary video that guides you through this as well. You can check it out <a title=\"Supplementary video\" href=\"http://www.youtube.com/watch?v=MqyGvEXuif4\" target=\"_blank\">here</a>.</p>\n<h2 class=\"steps\">Conclusion</h2>\n<p>Anyway, those were my findings while working with FBX, and I couldn&#8217;t find information on this anywhere else.</p>\n<p>Hope it helps!</p>\n<p>*UPDATE* Caught embarrassing mistake. Thanks <a href=\"http://www.grantlucas.com/\">Grant</a>!</p>\n"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"autodesk-maya-exporting-to-fbx"}}